{% extends "base.html" %}

{% block extra_css %}
<link href="{{ url_for('static', filename='css/transfers.css') }}" media="screen" rel="stylesheet" type="text/css">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/transfers.js') }}" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="content-new-trigger"></div>

<div class="content-div content-new element-highlight">
    <div class="element-base">
        <form>
            <table class="table-info">
                <tr>
                    <td><span>Source</span></td>
                    <td><input class="input-text" type="text" name="src" placeholder="source URI" /></td>
                </tr>
                <tr>
                    <td><span>Destination</span></td>
                    <td><input class="input-text" type="text" name="dst" placeholder="destination path" /></td>
                </tr>
                <tr>
                    <td><span>Type</span></td>
                    <td>
                        <select title="type" name="type">
                            <option value="">auto</option>
                            <option value="torrent">torrent</option>
                        </select>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div>
        <pre class="add-message"></pre>
    </div>

    <div class="element-new-actions">
        <a href=""><img class="img-button" src="{{ url_for('static', filename='img/add.png') }}" alt="add"></img></a>
    </div>
</div>

{% for item in items %}
    <div class="content-div content-element" data-id="{{ item._id }}">
        <div class="element-name">
            <input type="hidden" name="id" value="{{ item._id }}" />

            <span class="transfer-type">{{ item.type }}</span>
            <span class="transfer-name text-title"></span>
            <div class="progressbox">
                <div class="progress">
                    <div class="progressbar"></div>
                </div>
            </div>
        </div>

        <div class="element-actions">
            <a href=""><img class="img-button" src="{{ url_for('static', filename='img/remove.png') }}" alt="remove"></img></a>
        </div>

        <div class="element-info element-base">
            <table class="table-info">
                {% for key, val in [('Created', item.created), ('Started', item.started), ('Source', item.src|truncate(80, True)), ('Destination', item.dst)] %}
                    <tr>
                        <td><span>{{ key }}:</span></td>
                        <td><span>{% if val != None %}{{ val }}{% else %}-{% endif %}</span></td>
                    </tr>
                {% endfor %}

                <tr>
                    <td><span>Transferred:</span></td>
                    <td><span class="transfer-transferred"></span> MB</td>
                </tr>
                <tr>
                    <td><span>Size:</span></td>
                    <td><span class="transfer-size"></span> MB</td>
                </tr>
                <tr>
                    <td><span>Download rate:</span></td>
                    <td><span class="transfer-rate"></span> KB/s</td>
                </tr>
                <tr>
                    <td><span>Progress:</span></td>
                    <td><span class="transfer-progress"></span> %</td>
                </tr>

                {% for key, val in [('Hash', item.info.hash), ('Status', item.info.status), ('Last activity', item.info.date_active), ('Download directory', item.info.download_dir)] %}
                    <tr>
                        <td><span>{{ key }}:</span></td>
                        <td><span>{% if val %}{{ val }}{% else %}-{% endif %}</span></td>
                    </tr>
                {% endfor %}
                {% if item.info.files %}
                    {% for file in item.info.files %}
                    <tr>
                        <td><span>{% if loop.first %}Files:{% endif %}</span></td>
                        <td><span>{{ file }}</span></td>
                    </tr>
                    {% endfor %}
                {% endif %}
                {% if item.info.error_string %}
                    <tr>
                        <td><span>Error:</span></td>
                        <td><span>{{ item.info.error_string }}</span></td>
                    </tr>
                {% endif %}
            </table>
        </div>

    </div>
{% endfor %}
{% endblock %}
