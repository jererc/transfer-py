{% extends "base.html" %}

{% block extra_css %}
<link href="{{ url_for('static', filename='css/transfers.css') }}" media="screen" rel="stylesheet" type="text/css">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/transfers.js') }}" type="text/javascript"></script>
{% endblock %}

{% block content %}
<div class="content-div content-new">
    <div class="element-new">
        <form>
            <table>
                <tr>
                    <td><span class="text-normal">Source</span></td>
                    <td><input class="input-text" type="text" name="src" placeholder="source URI" /></td>
                </tr>
                <tr>
                    <td><span class="text-normal">Destination</span></td>
                    <td><input class="input-text" type="text" name="dst" placeholder="destination path" /></td>
                </tr>
                <tr>
                    <td><span class="text-normal">Type</span></td>
                    <td>
                        <select title="type" name="type">
                            <option value="">auto</option>
                            <option value="torrent">torrent</option>
                        </select>
                    </td>
                </tr>
            </table>
        </form>

        <div>
            <pre class="add-message"></pre>
        </div>
    </div>

    <div class="element-new-actions">
        <a href=""><img class="img-button" src="{{ url_for('static', filename='img/add.png') }}" alt="add"></img></a>
    </div>
</div>

{% for item in items %}
    <div class="content-div content-element" data-id="{{ item._id }}">
        <div class="element-name">
            <input type="hidden" name="id" value="{{ item._id }}" />

            <span class="transfer-type">{{ item.type }}</span>
            <span class="transfer-name text-title"></span>
            <div class="progressbox">
                <div class="progress">
                    <div class="progressbar"></div>
                </div>
            </div>
        </div>

        <div class="element-actions">
            <a href=""><img class="img-button" src="{{ url_for('static', filename='img/remove.png') }}" alt="remove"></img></a>
        </div>

        <div class="element-info text-normal">
            <table>
                {% for key, val in [('Created', item.created), ('Started', item.started), ('Source', item.src|truncate(80, True)), ('Destination', item.dst)] %}
                    <tr>
                        <td>{{ key }}:</td>
                        <td>{% if val != None %}{{ val }}{% else %}-{% endif %}</td>
                    </tr>
                {% endfor %}

                <tr>
                    <td>Transferred:</td>
                    <td><span class="transfer-transferred"></span> MB</td>
                </tr>
                <tr>
                    <td>Size:</td>
                    <td><span class="transfer-size"></span> MB</td>
                </tr>
                <tr>
                    <td>Download rate:</td>
                    <td><span class="transfer-rate"></span> KB/s</td>
                </tr>
                <tr>
                    <td>Progress:</td>
                    <td><span class="transfer-progress"></span> %</td>
                </tr>

                {% for key, val in [('Hash', item.info.hash), ('Status', item.info.status), ('Last activity', item.info.date_active), ('Download directory', item.info.download_dir)] %}
                    <tr>
                        <td>{{ key }}:</td>
                        <td>{% if val %}{{ val }}{% else %}-{% endif %}</td>
                    </tr>
                {% endfor %}
                {% if item.info.files %}
                    {% for file in item.info.files %}
                    <tr>
                        <td>{% if loop.first %}Files:{% endif %}</td>
                        <td>{{ file }}</td>
                    </tr>
                    {% endfor %}
                {% endif %}
                {% if item.info.error_string %}
                    <tr>
                        <td><span>Error:</span></td>
                        <td>{{ item.info.error_string }}</td>
                    </tr>
                {% endif %}
            </table>
        </div>

    </div>
{% endfor %}
{% endblock %}
